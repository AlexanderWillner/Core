% bugfixes ---------------------------------------------------------------------
%\let\spvec\vec                   % llncs with amsmath bugfix
%\let\vec\accentvec               % llncs with amsmath bugfix
%\newcommand{\subparagraph}{}     % IEEETrans with titlesec bugfix

%\makeatletter                    % for old listings package
%\@ifundefined{float@listhead}{}{%
%    \renewcommand*{\lstlistoflistings}{%
%        \begingroup
%            \if@twocolumn
%                \@restonecoltrue\onecolumn
%            \else
%                \@restonecolfalse
%            \fi
%            \float@listhead{\lstlistlistingname}%
%            \setlength{\parskip}{\z@}%
%            \setlength{\parindent}{\z@}%
%            \setlength{\parfillskip}{\z@ \@plus 1fil}%
%            \@starttoc{lol}%
%            \if@restonecol\twocolumn\fi
%        \endgroup
%    }%
%}
%\makeatother
% ------------------------------------------------------------------------------

% macro: ifpackageloaded -------------------------------------------------------
\makeatletter
\providecommand{\IfPackageLoaded}[2]{\@ifpackageloaded{#1}{#2}{}}
\providecommand{\IfPackageNotLoaded}[2]{\@ifpackageloaded{#1}{}{#2}}
\providecommand{\IfElsePackageLoaded}[3]{\@ifpackageloaded{#1}{#2}{#3}}
\makeatother
% ------------------------------------------------------------------------------

% File encoding: Normal UTF8
\IfPackageNotLoaded{CJKutf8}{\usepackage[utf8x]{inputenc}}

\usepackage{cmap}                     % Support copy and search for pdflatex
\input{glyphtounicode}                % Support copy and search for pdflatex
\pdfgentounicode=1                    % Support copy and search for pdflatex
\usepackage{amssymb}                  % Springer Verlag (pdflatex)
\usepackage[pdftex,                   % Hyperlinks in PDFs
raiselinks=true,			          % calculate real height of the link
breaklinks,                           % break links
backref=page,                         % backlinks in bibliography (section, slide, page, none)
pagebackref=true,                     % backlinks in bibliography
hyperindex=true,                      % backlinkex index
linktocpage=true,                     % ToC links pages
bookmarks=true,                       % Bookmarks for PDF viewers
bookmarksopen=true,                   % Open bookmarks
bookmarksopenlevel=1,                 % How many levels to open
bookmarksnumbered=true,               % Numbers in the bookmarks
bookmarkstype=toc,                    % Type of bookmark
plainpages=false,                     % Anchors even on plain pages?
pageanchor=true,                      % Pages are linkable
pdfstartview=FitH,                    % Open document with Fit Width
pdfpagelabels=true,                   % set PDF page labels
pdfpagemode=UseOutlines,              % Show bookmarks in viewer
colorlinks,                           % Show colored links
linkcolor=LinkColor,                  % Link color
urlcolor=LinkColor,                   % URL color
anchorcolor=LinkColor,                % Anchor color
citecolor=LinkColor,                  % Cite color
menucolor=LinkColor,                  % Menu color
hypertexnames=true                    % Whatever ;)
]{hyperref}                           % Use hyperlinks
\usepackage[tracking=true,            % Fonts: hyphenatable letterspacing
expansion=true,                       % Fonts: better grey value
protrusion=true]{microtype}           % Fonts: margin kerning
\usepackage[T1]{fontenc}              % Font encoding: T1
\usepackage{textcomp}                 % For the Euro sign
\usepackage{booktabs}                 % Nice tables
\usepackage{listings}                 % Nice listings
\usepackage{url}                      % Create URLs in the document
\usepackage{color}                    % To use and define colors
\definecolor{LinkColor}{rgb}          % Link color
{0.31,0.46,.64}                       %
\definecolor{MarginColor}{rgb}        % Margin color
{0.31,0.46,.64}                       %
\renewcommand*{\backref}[1]{[cited at page #1]}% Show formatted backlinks
\usepackage{marginnote}               % Non floating margin notes
\usepackage[caption=false]{subfig}    % Many figures in one environment
\usepackage{stfloats}                 % Makes LaTeX honour ‘[b]’ placement
\usepackage{amsmath}                  % For eqref
\usepackage{paralist}                 % For inline lists
\usepackage{fixltx2e}                 % Provides fixes for LaTeX
\usepackage{fix-cm}                   % Provides fixes for LaTeX
\usepackage{rotating}                 % e.g. for the special side margin notes
\usepackage{lipsum}                   % To add some dummy text
\usepackage{xspace}                   % Fixing some spacing issues
\usepackage{ellipsis}                 % Puts space around ellipses
\usepackage{ragged2e}                 % New commands/env. for setting ragged text
\usepackage{lmodern}                  % Nicer fonts (for all)
\usepackage{ltxtable}                 % Long complex tables
\usepackage[switch*,modulo]{lineno}   % Show line numbers

\newcommand{\etc}{etc.\@\xspace}      % Fixing some spacing issues
\lstset{columns=fullflexible}         % Listings in multicolumn mode

% To be used in the project specific config file:
%\usepackage[bf]{caption}[2008/08/24]  % Bold caption (better contrast)
%\usepackage{acronym}                  % For acronyms
%\usepackage[pdftex]{graphicx}         % Include images for pdflatex

\hyphenation{op-tical net-works semi-conduc-tor con-cept}

\renewcommand{\figurename}{Fig.}
\renewcommand{\tablename}{Tab.}
\newcommand{\sectionname}{Sec.}
\newcommand{\equationname}{Eq.}

\makeindex

\setcounter{tocdepth}{3}
\newcommand{\mykeywords}[1]{\par\addvspace\baselineskip
\keywordname\enspace\ignorespaces#1}
\makeatletter
\providecommand*{\toclevel@title}{99}
\providecommand*{\toclevel@author}{99}


% annotations --------------------------------------------------------------
\newcommand{\annot}[2][]{%
    \pdfannot width \linewidth height 2\baselineskip depth 0pt{%
        /Subtype/Text%
        /Open false
        /Name /Comment%
        /CA .4%
        /C [.3 .6 .9]%
        /T (\pdfescapestring{#1})%            /Contents(\pdfescapestring{\detokenize{#2}})%
    }
}


\setlength{\marginparwidth}{0.7in}
\newcommand\sidenote[1]{%
  \marginnote{%
    \scriptsize%
    \raggedright%
    \hspace{0pt}%
    \color{MarginColor}%
    \begin{turn}{270}%
      \emph{#1}%
    \end{turn}%
  }
}

%for two-column layout
\makeatletter
\g@addto@macro\@mn@margintest{%
  \if@twocolumn
    \ifx\@mn@currxpos\relax% don't know which margin use normal one
      \normalmarginpar
    \else\ifx\@mn@currxpos\@empty% don't know which margin use normal one
        \normalmarginpar
      \else
        \if@tempswa% use \oddsidemargin for tests
          \ifdim\@mn@currxpos >\dimexpr \oddsidemargin+1in+\columnwidth\relax
            \normalmarginpar% right column --> right margin
          \else
            \reversemarginpar% left column --> left margin
          \fi
        \else% use \evensidemargin for tests
          \ifdim\@mn@currxpos >\dimexpr \evensidemargin+1in+\columnwidth\relax
            \reversemarginpar% right column --> right margin
          \else
            \normalmarginpar% left column --> left margin
          \fi
        \fi
      \fi
    \fi
  \fi
}
\makeatother
% annotations --------------------------------------------------------------
